<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Painel Financeiro</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@200;300;400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    body {
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      font-family: 'Plus Jakarta Sans', sans-serif;
    }
    
    /* Chart container styles */
    .chart-container {
      position: relative;
      width: 100%;
      height: 100%;
    }
    
    .chart-container canvas {
      width: 100% !important;
      height: 100% !important;
      display: block;
    }
    
    /* Double row layout */
    .chart-row.double {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
    }
    
    .chart-row.double .card {
      flex: 1 1 calc(50% - 10px);
      min-width: 300px;
    }
    
    .chart-row.double .chart-container {
      height: 300px;
    }
    
    /* Single row layout */
    .chart-row.single .chart-container {
      height: 400px;
    }
    
    /* Pie chart layout */
    #department-breakdown-charts {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
    }
    
    #department-breakdown-charts canvas {
      width: 100% !important;
      max-width: 400px;
      height: 300px !important;
    }
  </style>
  <link rel="stylesheet" href="styles/style.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
  <div class="dashboard container">
    <div class="view-toggle">
      <button id="btn-graphs" class="active">Gráficos</button>
      <button id="btn-tables">Tabelas</button>
    </div>

    <!-- Charts View -->
    <div id="charts-view">
      <!-- Row 1: Total Expenditures -->
      <div class="chart-row single" id="total-expenditures-wrapper">
        <div class="card">
          <img src="assets/logo.png" alt="Facto Logo" class="facto-logo">
          <h2>Gastos Totais ao Longo do Tempo</h2>
          <div class="time-filters">
            <button class="time-btn" data-months="3">3</button>
            <button class="time-btn" data-months="6">6</button>
            <button class="time-btn active" data-months="12">12</button>
          </div>
          <div class="filter-buttons">
            <button class="filter-btn active" data-department="all">Todos</button>
            <button class="filter-btn" data-department="Administrativo">Administrativo</button>
            <button class="filter-btn" data-department="Comercial">Comercial</button>
            <button class="filter-btn" data-department="Diretoria">Diretoria</button>
            <button class="filter-btn" data-department="Operação">Operação</button>
            <button class="filter-btn" data-department="RH">RH</button>
            <button class="filter-btn" data-department="NEC">NEC</button>
            <button class="filter-btn" data-department="Apoio">Apoio</button>
            <button class="filter-btn" data-department="Marketing">Marketing</button>
            <button class="filter-btn" data-department="Jurídico">Jurídico</button>
          </div>
          <div class="chart-container">
            <canvas id="total-expenditures-chart"></canvas>
          </div>
        </div>
      </div>

      <!-- Row 2: Department Expenditures -->
      <div class="chart-row single" id="department-trends-wrapper">
        <div class="card">
          <h2>Gastos por Departamento</h2>
          <div class="time-filters">
            <button class="time-btn" data-months="3">3</button>
            <button class="time-btn" data-months="6">6</button>
            <button class="time-btn active" data-months="12">12</button>
          </div>
          <div class="filter-buttons">
            <button class="filter-btn active" data-departments='all'>Mostrar Todos</button>
            <button class="filter-btn" data-departments='["Comercial","Diretoria","Operação"]'>Principais</button>
            <button class="filter-btn" data-departments='["Administrativo","RH","NEC","Apoio","Marketing","Jurídico"]'>Demais</button>
          </div>
          <div class="chart-container">
            <canvas id="department-trends-chart"></canvas>
          </div>
        </div>
      </div>

      <!-- Row 3: Average Expenditure & Total Employees -->
      <div class="chart-row double">
        <div class="card">
          <h2>Média de Gastos por Funcionário</h2>
          <div class="chart-container">
            <canvas id="avg-expenditure-chart"></canvas>
          </div>
        </div>
        <div class="card">
          <h2>Total de Funcionários</h2>
          <div class="chart-container">
            <canvas id="employees-chart"></canvas>
          </div>
        </div>
      </div>

      <!-- Row 4: Department Cost Share (Full Width) -->
      <div class="chart-row single">
        <div class="card">
          <h2>Participação Percentual por Departamento</h2>
          <div class="chart-container">
            <canvas id="percentage-stacked-chart"></canvas>
          </div>
        </div>
      </div>

      <!-- Row 5: Department Breakdown -->
      <div class="card" id="department-breakdown-wrapper">
        <h2>Distribuição de Gastos por Departamento (Últimos 6 Meses)</h2>
        <div class="pie-chart-row" id="department-breakdown-charts">
          <!-- Pie charts will be inserted here by JavaScript -->
        </div>
        <div class="department-legend" id="department-legend">
          <!-- Legend items will be inserted here by JavaScript -->
        </div>
      </div>
    </div>

    <!-- Tables View (Hidden by Default) -->
    <div id="tables-view" class="hidden">
      <div class="card">
        <!-- Filter buttons for summary/detailed -->
        <div class="filter-group">
          <button id="btn-summary-month" class="active">Resumo por Mês</button>
          <button id="btn-summary-department">Resumo por Departamento</button>
          <button id="btn-detailed-month">Por Mês (detalhado)</button>
          <button id="btn-detailed-department">Por Departamento (detalhado)</button>
        </div>

        <!-- Table containers -->
        <div id="table-summary-month"></div>
        <div id="table-summary-department" class="hidden"></div>
        <div id="table-detailed-month" class="hidden"></div>
        <div id="table-detailed-department" class="hidden"></div>
      </div>
    </div>

    <script>
      // Initialize Chart.js defaults
      Chart.defaults.font.family = "'Plus Jakarta Sans', sans-serif";
      Chart.defaults.font.size = 12;
      Chart.defaults.elements.line.tension = 0.4;
      Chart.defaults.maintainAspectRatio = false;
      Chart.defaults.responsive = true;
    </script>
    <script src="scripts/app.js"></script>
  </div>
</body>
</html>
